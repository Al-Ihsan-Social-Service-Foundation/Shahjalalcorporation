<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shahjalal Corporation - Corporate Demo App (Final)</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-color: #004d99; /* Deep Blue */
            --accent-color: #337ab7; /* Lighter Blue */
            --light-bg: #f4f7f6;
            --card-bg: #ffffff;
            --text-color: #333;
            --border-color: #ddd;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Roboto', sans-serif;
        }

        body {
            background-color: var(--light-bg);
            color: var(--text-color);
            line-height: 1.6;
        }

        /* --- Utility Classes --- */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .text-center { text-align: center; }
        .text-success { color: green; font-weight: bold; }
        .text-danger { color: red; font-weight: bold; }

        /* --- Home/Login Styles --- */
        #home-page {
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }
        
        header {
            background-color: var(--primary-color);
            color: white;
            padding: 20px 0;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo-info h1 {
            font-size: 2em;
            margin-bottom: 5px;
        }

        .contact-info p {
            font-size: 1em;
            margin: 0;
        }
        
        .branch-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 30px;
            margin-top: 40px;
        }

        .branch-card {
            background-color: var(--card-bg);
            border-radius: 8px;
            padding: 30px;
            text-align: center;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.08);
            transition: transform 0.3s, box-shadow 0.3s;
            cursor: pointer;
            border-top: 5px solid var(--accent-color);
        }

        .branch-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 15px rgba(0, 0, 0, 0.15);
        }

        #login-page {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background-color: var(--light-bg);
        }

        .login-box {
            background-color: var(--card-bg);
            padding: 40px;
            border-radius: 8px;
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
            width: 100%;
            max-width: 400px;
            text-align: center;
            position: relative;
        }
        
        .login-box input[type="text"],
        .login-box input[type="password"],
        .login-box button {
            width: 100%;
            padding: 12px;
            margin-bottom: 15px;
            border-radius: 4px;
            border: 1px solid var(--border-color);
            font-size: 1em;
        }

        .login-box button {
            background-color: var(--accent-color);
            color: white;
            border: none;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        /* --- Dashboard Styles --- */
        #dashboard {
            display: none;
            min-height: 100vh;
        }

        .dashboard-layout {
            display: flex;
        }

        .sidebar {
            width: 250px;
            background-color: var(--primary-color);
            color: white;
            padding: 20px 0;
            box-shadow: 2px 0 5px rgba(0, 0, 0, 0.1);
            flex-shrink: 0;
        }
        
        .sidebar nav a {
            display: block;
            padding: 12px 20px;
            text-decoration: none;
            color: white;
            transition: background-color 0.2s;
            border-left: 5px solid transparent;
        }

        .sidebar nav a.active,
        .sidebar nav a:hover {
            background-color: rgba(255, 255, 255, 0.1);
            border-left: 5px solid var(--accent-color);
        }

        .main-content {
            flex-grow: 1;
            padding: 20px;
        }

        .dashboard-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding: 10px 0;
            border-bottom: 2px solid var(--border-color);
        }

        /* --- Section Styling --- */
        .dashboard-section {
            background-color: var(--card-bg);
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
            margin-bottom: 20px;
        }

        .dashboard-section h2 {
            color: var(--accent-color);
            border-bottom: 2px solid var(--light-bg);
            padding-bottom: 10px;
            margin-bottom: 20px;
        }

        /* --- List/Selector Styles --- */
        .selector-view, .transaction-view {
            padding: 15px;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            margin-bottom: 20px;
            background-color: #eaf4fb;
        }
        
        .selector-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px;
            margin: 5px 0;
            background-color: white;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            cursor: pointer;
            transition: background-color 0.2s;
        }
        
        .selector-item:hover {
            background-color: #f0f8ff;
        }
        
        .selector-item button {
            background-color: var(--accent-color);
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 3px;
            cursor: pointer;
        }
        
        .transaction-view h3 {
            color: var(--primary-color);
            margin-bottom: 15px;
        }

        /* --- Form Styling --- */
        .form-row {
            display: flex;
            gap: 20px;
            margin-bottom: 15px;
            flex-wrap: wrap;
        }

        .form-group {
            flex: 1;
            min-width: 200px;
        }

        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 10px;
            border: 1px solid var(--border-color);
            border-radius: 4px;
        }

        .submit-btn {
            background-color: green;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        
        .submit-btn:hover {
            background-color: darkgreen;
        }

        /* Table Styling */
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
            font-size: 0.9em;
        }

        table th, table td {
            padding: 10px 15px;
            border: 1px solid var(--border-color);
            text-align: left;
        }
        
        table th {
            background-color: var(--accent-color);
            color: white;
        }
        
        .total-row td {
            font-weight: bold;
            background-color: #e6f7ff;
        }

        /* Screen Management */
        .screen {
            display: none;
        }
        .hidden-section {
            display: none;
        }
        
        /* Summary Card */
        .summary-card {
            background-color: #e6f7ff;
            padding: 20px;
            border-radius: 8px;
            text-align: center;
            margin-bottom: 20px;
            border-left: 5px solid var(--accent-color);
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }
        .summary-card h3, .summary-card h4 {
            color: var(--primary-color);
            font-size: 1.5em;
            margin-bottom: 10px;
        }
        .due-list-item {
            padding: 10px;
            border-bottom: 1px dotted var(--border-color);
            display: flex;
            justify-content: space-between;
        }
        
        /* Admin View Grid */
        #branch-performance-container {
            display: grid; 
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); 
            gap: 20px; 
            margin-top: 20px;
        }
    </style>
</head>
<body>

    <div id="home-page" class="screen active">
        <header>
            <div class="container header-content">
                <div class="logo-info">
                    <h1>Shahjalal Corporation</h1>
                    <p>Logistics & Supply Chain Management</p>
                </div>
                <div class="contact-info">
                    <p>📞 +880 1XXXXXXXXX</p>
                    <p>📧 info@shahjalalcorp.com</p>
                </div>
            </div>
        </header>

        <main class="container">
            <h1 class="text-center" style="color: var(--primary-color);">Select Your Branch to Login</h1>
            <div class="branch-grid">
                <div class="branch-card" onclick="showLogin('Mirpur Branch')">
                    <h2>Mirpur Branch</h2>
                    <p>Location: Dhaka North</p>
                </div>
                <div class="branch-card" onclick="showLogin('Baipail Branch')">
                    <h2>Baipail Branch</h2>
                    <p>Location: Savar Industrial Area</p>
                </div>
                <div class="branch-card" onclick="showLogin('Konabari Branch')">
                    <h2>Konabari Branch</h2>
                    <p>Location: Gazipur Zone</p>
                </div>
                <div class="branch-card" onclick="showLogin('Admin View')" style="border-top: 5px solid red;">
                    <h2>Admin Demo View</h2>
                    <p>Centralized Access (Demo)</p>
                </div>
            </div>
        </main>

        <footer>
            <div class="container">
                &copy; 2025 Shahjalal Corporation. All rights reserved.
            </div>
        </footer>
    </div>

    <div id="login-page" class="screen">
        <div class="login-box">
            <button onclick="showScreen('home-page')" style="position: absolute; top: 10px; right: 10px; background: none; color: #666; border: none; font-size: 1.5em; cursor: pointer;">&times;</button>
            <h2 id="login-branch-name">Branch Login</h2>
            <p>Demo Credentials: **user:** `branch`, **pass:** `1234`</p>
            <input type="text" id="login-username" placeholder="Username (branch)" value="branch">
            <input type="password" id="login-password" placeholder="Password (1234)" value="1234">
            <button onclick="handleLogin()">Login</button>
            <p id="login-error-message" class="login-message" style="display: none;">Invalid Credentials. Please try again.</p>
        </div>
    </div>

    <div id="dashboard" class="screen">
        <div class="dashboard-layout">
            <div class="sidebar">
                <h3>Shahjalal Corp</h3>
                <nav>
                    <ul>
                        <li><a href="#" class="nav-item active" data-section="ledger">Customer Ledger</a></li>
                        <li><a href="#" class="nav-item" data-section="stock">Stock Summary</a></li>
                        <li><a href="#" class="nav-item" data-section="goods">Goods In / Out</a></li>
                        <li><a href="#" class="nav-item" data-section="due">Due List</a></li>
                        <li><a href="#" class="nav-item" data-section="sales-report">Sales Report</a></li>
                        <li><a href="#" class="nav-item" data-section="reminder">Reminder System</a></li>
                        <li><a href="#" class="nav-item" onclick="handleLogout()">Logout</a></li>
                    </ul>
                </nav>
            </div>

            <div class="main-content">
                <div class="dashboard-header">
                    <div>
                        <h1 id="dashboard-title"></h1>
                        <p>Company:
                            <select id="company-filter" onchange="updateDashboardView()">
                                <option value="Shahjalal Corporation">Shahjalal Corporation</option>
                                <option value="MM Corporation">MM Corporation</option>
                            </select>
                        </p>
                    </div>
                    <div class="user-info">
                        <span id="user-branch-name"></span>
                        <small>Role: <span id="user-role">Branch User</span></small>
                        <button class="logout-btn" onclick="handleLogout()">Logout</button>
                    </div>
                </div>

                <section id="ledger-section" class="dashboard-section section-active hidden-section">
                    <h2>Customer Ledger</h2>

                    <div id="customer-selector-view">
                        <h3>Select or Add a Customer:</h3>
                        <div class="form-group" style="display: flex; gap: 10px; margin-bottom: 10px;">
                            <input type="text" id="customer-filter-input" placeholder="Search Customer Name..." onkeyup="populateCustomerList()" style="flex: 2;">
                            <input type="text" id="new-customer-name" placeholder="Enter New Customer Name" style="flex: 2;">
                            <button class="submit-btn" onclick="addCustomer()" style="flex: 1;">Add Customer</button>
                        </div>
                        <div id="customer-list-container">
                            </div>
                    </div>

                    <div id="customer-transaction-view" class="transaction-view" style="display: none;">
                        <button onclick="showCustomerSelector()" style="float: right; padding: 5px 10px;">&larr; Back to List</button>
                        <h3 id="current-customer-name">Customer Name</h3>
                        <p>Current Balance: <span id="customer-current-balance" class="text-success">0</span> BDT</p>

                        <h4>Add New Transaction:</h4>
                        <form onsubmit="addCustomerTransaction(event)">
                            <div class="form-row">
                                <div class="form-group"><label>Date:</label><input type="date" id="t-date" required value="2025-10-17"></div>
                                <div class="form-group"><label>Description:</label><input type="text" id="t-desc" required value="Sales/Payment"></div>
                                <div class="form-group"><label>Bill No:</label><input type="text" id="t-bill" value="BILL-00X"></div>
                            </div>
                            <div class="form-row">
                                <div class="form-group"><label>Debit (Sales/Due):</label><input type="number" id="t-debit" value="0"></div>
                                <div class="form-group"><label>Credit (Payment/Deposit):</label><input type="number" id="t-credit" value="0"></div>
                            </div>
                            <button type="submit" class="submit-btn">Entry Transaction (Demo)</button>
                        </form>
                        
                        <div class="table-responsive">
                            <table id="customer-ledger-table">
                                <thead>
                                    <tr><th>Date</th><th>Description</th><th>Bill No</th><th>Debit</th><th>Credit</th><th>Balance</th></tr>
                                </thead>
                                <tbody></tbody>
                            </table>
                        </div>
                    </div>
                </section>

                <section id="stock-section" class="dashboard-section hidden-section">
                    <h2>Stock Summary (Product-wise)</h2>

                    <div id="product-selector-view">
                        <h3>Select or Add a Product:</h3>
                         <div class="form-group" style="display: flex; gap: 10px; margin-bottom: 10px;">
                            <input type="text" id="product-filter-input" placeholder="Search Product Name..." onkeyup="populateProductList()" style="flex: 2;">
                            <input type="text" id="new-product-name" placeholder="Enter New Product Name" style="flex: 2;">
                            <button class="submit-btn" onclick="addProduct()" style="flex: 1;">Add Product</button>
                        </div>
                        <div id="product-list-container">
                            </div>
                    </div>

                    <div id="product-movement-view" class="transaction-view" style="display: none;">
                        <button onclick="showProductSelector()" style="float: right; padding: 5px 10px;">&larr; Back to List</button>
                        <h3 id="current-product-name">Product Name</h3>
                        <p>Total Stock: <span id="product-total-stock" class="text-success">0</span> Units</p>

                        <h4>Add New Stock Movement:</h4>
                        <form onsubmit="addProductStock(event)">
                            <div class="form-row">
                                <div class="form-group"><label>Date:</label><input type="date" id="s-date" required value="2025-10-17"></div>
                                <div class="form-group"><label>Company:</label><input type="text" id="s-company-detail" required value="Shahjalal Corporation"></div>
                                <div class="form-group"><label>Bill No:</label><input type="text" id="s-bill-detail" value="GR-00X"></div>
                            </div>
                            <div class="form-row">
                                <div class="form-group"><label>Goods In (Units):</label><input type="number" id="s-in" value="0" min="0"></div>
                                <div class="form-group"><label>Goods Out (Units):</label><input type="number" id="s-out" value="0" min="0"></div>
                                <div class="form-group"><label>Unit Price:</label><input type="number" id="s-price" value="100" min="0"></div>
                            </div>
                            <button type="submit" class="submit-btn">Entry Stock Movement (Demo)</button>
                        </form>
                        
                        <div class="table-responsive">
                            <table id="stock-summary-table">
                                <thead>
                                    <tr><th>Date</th><th>Company</th><th>Bill No</th><th>Goods In</th><th>Goods Out</th><th>Unit Price</th><th>Final Stock</th></tr>
                                </thead>
                                <tbody></tbody>
                            </table>
                        </div>
                    </div>
                </section>

                <section id="goods-section" class="dashboard-section hidden-section">
                    <h2>Goods Transaction Input (Quick Stock Entry)</h2>
                    <p>Enter data here for quick logging. This entry should ideally feed into the Stock Summary system।</p>
                    <form onsubmit="handleGoodsInput(event)">
                        <div class="form-row">
                            <div class="form-group">
                                <label for="goods-date">Date:</label>
                                <input type="date" id="goods-date" required value="2025-10-17">
                            </div>
                            <div class="form-group">
                                <label for="goods-company">Company Name:</label>
                                <input type="text" id="goods-company" required value="Shahjalal Corp">
                            </div>
                            <div class="form-group">
                                <label for="goods-billno">Bill No:</label>
                                <input type="text" id="goods-billno" required value="GR-007">
                            </div>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label for="goods-type">Transaction Type:</label>
                                <select id="goods-type" required onchange="updateGoodsLabels(this.value)">
                                    <option value="in">Goods In</option>
                                    <option value="out">Goods Out</option>
                                </select>
                            </div>
                             <div class="form-group" style="flex: 2; min-width: 400px;">
                                <label for="goods-product-filter">Search & Select Product:</label>
                                <div style="display: flex; gap: 5px;">
                                    <input type="text" id="goods-product-filter" placeholder="Type to filter..." onkeyup="filterQuickEntryProducts()" style="width: 40%; min-width: 120px;">
                                    <select id="goods-product-select" required style="width: 60%;" onchange="updateQuickEntryForm(this.value)">
                                        </select>
                                </div>
                            </div>
                             <div class="form-group">
                                <label for="goods-quantity">Quantity (Pcs/Units):</label>
                                <input type="number" id="goods-quantity" required value="100" min="1" oninput="calculateGoodsTotal()">
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label for="goods-unit-price">Unit Price:</label>
                                <input type="number" id="goods-unit-price" required value="150" min="0" oninput="calculateGoodsTotal()">
                            </div>
                            <div class="form-group">
                                <label>Total Price (Calculated):</label>
                                <input type="text" id="goods-total-price" value="15,000" readonly style="background-color: #f0f0f0; font-weight: bold;">
                            </div>
                             <div class="form-group">
                                <label>Final Stock (Demo):</label>
                                <input type="text" id="goods-final-balance" value="N/A" readonly style="background-color: #f0f0f0; font-weight: bold;">
                            </div>
                        </div>

                        <div class="form-group">
                            <button type="submit" class="submit-btn">Record Transaction (Demo)</button>
                        </div>
                    </form>
                </section>

                <section id="due-section" class="dashboard-section hidden-section">
                    <h2>Weekly Due Customers</h2>
                    <div id="due-list-content">
                        <div class="due-list-item"><span>👤 Smart Traders</span><span class="text-danger">BDT 15,000</span></div>
                        <div class="due-list-item"><span>👤 Rahim Store</span><span class="text-danger">BDT 7,500</span></div>
                        <div class="due-list-item"><span>👤 Bhai Bhai Ent.</span><span class="text-danger">BDT 22,000</span></div>
                    </div>
                </section>

                <section id="sales-report-section" class="dashboard-section hidden-section">
                    <h2>Product-wise Sales Report</h2>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="report-period">Select Report Period:</label>
                            <select id="report-period" onchange="generateSalesReport()">
                                <option value="weekly">Weekly</option>
                                <option value="monthly">Monthly</option>
                                <option value="quarterly">Quarterly</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <div class="summary-card" style="margin-bottom: 0;">
                                <p>Total Sales Quantity</p>
                                <h3 id="total-sales-qty">250 Units</h3>
                            </div>
                        </div>
                        <div class="form-group">
                             <div class="summary-card" style="margin-bottom: 0;">
                                <p>Total Sales Amount</p>
                                <h3 id="total-sales-amount">BDT 3,75,000</h3>
                            </div>
                        </div>
                    </div>

                    <h3>Product Breakdown for <span id="report-period-display">Weekly</span> Report</h3>
                    <div class="table-responsive">
                        <table id="sales-report-table">
                            <thead>
                                <tr><th>Item Name</th><th>Sales Qty</th><th>Sales Amount (BDT)</th></tr>
                            </thead>
                            <tbody>
                                </tbody>
                        </table>
                    </div>
                </section>

                <section id="reminder-section" class="dashboard-section hidden-section">
                    <h2>Reminder System</h2>
                    <form onsubmit="addReminder(event)">
                        <div class="form-group">
                            <label for="reminder-text">New Reminder Note:</label>
                            <textarea id="reminder-text" rows="3" placeholder="E.g., Follow up with Mr. Kamal on 25th Oct."></textarea>
                        </div>
                        <button type="submit" class="submit-btn">Send Reminder (Demo)</button>
                    </form>
                    <h3>Active Reminders</h3>
                    <ul id="reminder-list" class="reminder-list"></ul>
                </section>
                
                 <section id="admin-view" class="dashboard-section hidden-section">
                    <h2>Admin Central View (Combined Branch Performance)</h2>
                    <p>আপনি এখানে সমস্ত ব্রাঞ্চের সমন্বিত এবং পৃথক কর্মক্ষমতা দেখতে পাচ্ছেন।</p>
                    
                    <div id="branch-performance-container">
                        <div class="summary-card" style="border-left: 5px solid #ff9900;">
                            <h4>Mirpur Branch Summary</h4>
                            <p>Total Sales (Oct): <span class="text-success">BDT 2,50,000</span></p>
                            <p>Total Due: <span class="text-danger">BDT 55,000</span></p>
                            <p>Active Customers: <span>120</span></p>
                            <button class="submit-btn" style="background-color: #ff9900;" onclick="viewBranchDetails('Mirpur')">View Full Report</button>
                        </div>
                        
                        <div class="summary-card" style="border-left: 5px solid #00aaff;">
                            <h4>Baipail Branch Summary</h4>
                            <p>Total Sales (Oct): <span class="text-success">BDT 1,80,000</span></p>
                            <p>Total Due: <span class="text-danger">BDT 32,000</span></p>
                            <p>Active Customers: <span>85</span></p>
                            <button class="submit-btn" style="background-color: #00aaff;" onclick="viewBranchDetails('Baipail')">View Full Report</button>
                        </div>
                        
                        <div class="summary-card" style="border-left: 5px solid #00cc66;">
                            <h4>Konabari Branch Summary</h4>
                            <p>Total Sales (Oct): <span class="text-success">BDT 95,000</span></p>
                            <p>Total Due: <span class="text-danger">BDT 15,000</span></p>
                            <p>Active Customers: <span>40</span></p>
                            <button class="submit-btn" style="background-color: #00cc66;" onclick="viewBranchDetails('Konabari')">View Full Report</button>
                        </div>
                    </div>
                    
                    <div class="export-btns" style="margin-top: 30px;">
                        <button onclick="alert('Demo: Exporting combined data to PDF.')" class="submit-btn">Export Combined PDF</button>
                        <button onclick="alert('Demo: Exporting combined data to Excel.')" class="submit-btn">Export Combined Excel</button>
                    </div>
                    
                    <div id="admin-branch-detail" class="dashboard-section hidden-section" style="margin-top: 20px; border: 1px solid var(--border-color);">
                        <h3 id="admin-detail-title"></h3>
                        <p>This is where the detailed Customer Ledger and Stock data for the selected branch would be displayed. (Demo only)</p>
                        <button onclick="hideBranchDetails()" class="submit-btn" style="background-color: #cc0000; margin-top: 10px;">&larr; Back to Summary</button>
                    </div>
                </section>

            </div>
        </div>
    </div>


    <script>
        // Global state for the demo
        let currentBranch = '';
        let currentRole = 'Branch User';
        let activeReminders = ['Check on overdue payment from Star Traders - BDT 15,000.'];
        let selectedCustomerId = null;
        let selectedProductId = null;

        // --- Demo Data (Dynamic and In-Memory) ---
        let CUSTOMER_DATA = {
            'CUST-001': { name: 'Smart Traders', company: 'Shahjalal Corporation', transactions: [
                { date: '2025-10-10', desc: 'Opening Balance', bill: 'OPN-001', debit: 0, credit: 0, balance: 50000 },
                { date: '2025-10-12', desc: 'Goods Sales (Bill-001)', bill: 'BILL-001', debit: 75000, credit: 0, balance: 125000 },
                { date: '2025-10-15', desc: 'Payment Received', bill: 'RC-001', debit: 0, credit: 50000, balance: 75000 }
            ]},
            'CUST-002': { name: 'Rahim Store', company: 'MM Corporation', transactions: [
                { date: '2025-10-05', desc: 'Opening Balance', bill: 'OPN-MM', debit: 0, credit: 0, balance: 20000 },
                { date: '2025-10-08', desc: 'Goods Sales (MM-001)', bill: 'MM-001', debit: 30000, credit: 0, balance: 50000 },
            ]}
        };

        let STOCK_DATA = {
            'PROD-001': { name: 'Product A', unitPrice: 150, movements: [
                { date: '2025-10-01', company: 'Shahjalal', bill: 'GR-001', type: 'in', qty: 500, price: 150, current_stock: 500 },
                { date: '2025-10-12', company: 'Shahjalal', bill: 'SR-001', type: 'out', qty: 100, price: 150, current_stock: 400 }, // Sale
                { date: '2025-10-15', company: 'Shahjalal', bill: 'SR-002', type: 'out', qty: 50, price: 150, current_stock: 350 }  // Sale
            ]},
            'PROD-002': { name: 'Product B', unitPrice: 250, movements: [
                { date: '2025-10-05', company: 'MM Corp', bill: 'GR-002', type: 'in', qty: 1000, price: 250, current_stock: 1000 },
                { date: '2025-10-16', company: 'MM Corp', bill: 'SR-MM3', type: 'out', qty: 100, price: 250, current_stock: 900 } // Sale
            ]}
        };
        let lastCustomerId = 2; // Counter for new customers
        let lastProductId = 2;   // Counter for new products


        // --- Navigation and Screen Management ---
        function showScreen(screenId) {
            document.querySelectorAll('.screen').forEach(screen => {
                screen.classList.remove('active');
                screen.style.display = 'none';
            });
            const targetScreen = document.getElementById(screenId);
            if (targetScreen) {
                targetScreen.classList.add('active');
                targetScreen.style.display = 'flex';
            }
        }

        function showLogin(branchName) {
            currentBranch = branchName;
            const is_admin = branchName === 'Admin View';
            document.getElementById('login-branch-name').textContent = is_admin ? 'Admin Login' : `${branchName} Login`;
            document.getElementById('login-username').value = is_admin ? 'admin' : 'branch';
            document.getElementById('login-error-message').style.display = 'none';
            showScreen('login-page');
        }

        function handleLogin() {
            const username = document.getElementById('login-username').value;
            const password = document.getElementById('login-password').value;
            const is_admin = currentBranch === 'Admin View';

            if ((username === 'branch' && password === '1234' && !is_admin) || (username === 'admin' && password === '1234' && is_admin)) {
                currentRole = is_admin ? 'Super Admin' : 'Branch User';
                initializeDashboard();
            } else {
                document.getElementById('login-error-message').textContent = 'Invalid Credentials. Please try again.';
                document.getElementById('login-error-message').style.display = 'block';
            }
        }

        function handleLogout() {
            currentBranch = '';
            currentRole = 'Branch User';
            showScreen('home-page');
        }

        function initializeDashboard() {
            const is_admin = currentBranch === 'Admin View';
            document.getElementById('dashboard-title').textContent = is_admin ? 'Central Admin Dashboard' : `${currentBranch} Dashboard`;
            document.getElementById('user-branch-name').textContent = is_admin ? 'Admin Access' : currentBranch;
            document.getElementById('user-role').textContent = currentRole;

            document.querySelectorAll('.dashboard-section').forEach(sec => sec.classList.add('hidden-section'));
            
            // --- Admin Specific Logic ---
            if (is_admin) {
                document.getElementById('admin-view').classList.remove('hidden-section');
                document.getElementById('admin-view').classList.add('section-active');
                // Hide irrelevant filters/menus for admin demo
                document.getElementById('company-filter').closest('p').style.display = 'none'; 
                document.querySelector('.sidebar nav').style.display = 'none';
                document.getElementById('admin-branch-detail').classList.add('hidden-section'); // Ensure detail view is hidden initially
                document.getElementById('branch-performance-container').style.display = 'grid'; // Ensure summary cards are visible

            } else {
                // Branch User Logic
                document.getElementById('company-filter').closest('p').style.display = 'block'; 
                document.querySelector('.sidebar nav').style.display = 'block';
                document.getElementById('admin-view').classList.add('hidden-section'); // Hide admin view for branch users

                 // Initialize customer/product selectors
                populateCustomerList();
                populateProductList();
                populateQuickEntryProductSelect(); // NEW: Populate the quick entry select
                generateSalesReport(); // Initialize sales report
                // Set default section view
                navigateToSection('ledger');
            }
            
            populateReminderList();
            showScreen('dashboard');
        }

        function navigateToSection(sectionId) {
            document.querySelectorAll('.dashboard-section').forEach(sec => {
                sec.classList.remove('section-active');
                sec.classList.add('hidden-section');
            });

            const targetSection = document.getElementById(sectionId + '-section');
            if (targetSection) {
                targetSection.classList.add('section-active');
                targetSection.classList.remove('hidden-section');
            }
            
            document.querySelectorAll('.sidebar nav a').forEach(a => a.classList.remove('active'));
            const navItem = document.querySelector(`.sidebar nav a[data-section="${sectionId}"]`);
            if(navItem) navItem.classList.add('active');

            // Reset views if necessary
            if (sectionId === 'ledger') showCustomerSelector();
            if (sectionId === 'stock') showProductSelector();
            if (sectionId === 'sales-report') generateSalesReport();
            if (sectionId === 'goods') {
                populateQuickEntryProductSelect(); // Refresh product list
                updateQuickEntryForm(document.getElementById('goods-product-select').value); // Load default product data
            }
        }
        
        document.querySelectorAll('.nav-item').forEach(item => {
            item.addEventListener('click', (e) => {
                const section = e.target.getAttribute('data-section');
                if (section && section !== 'logout') {
                    e.preventDefault();
                    navigateToSection(section);
                }
            });
        });

        // --- 3a) Customer Ledger Functions (Filter Added) ---
        
        function populateCustomerList() {
            const listContainer = document.getElementById('customer-list-container');
            const filterText = document.getElementById('customer-filter-input').value.toLowerCase().trim();
            listContainer.innerHTML = '';
            
            const companyFilter = document.getElementById('company-filter').value;

            Object.keys(CUSTOMER_DATA).forEach(id => {
                const customer = CUSTOMER_DATA[id];
                const latestBalance = customer.transactions.length > 0 ? customer.transactions[customer.transactions.length - 1].balance : 0;
                
                // Filter Logic: Check company and search text
                if ((customer.company === companyFilter || companyFilter === 'Shahjalal Corporation') && customer.name.toLowerCase().includes(filterText)) { 
                    
                    const item = document.createElement('div');
                    item.className = 'selector-item';
                    item.innerHTML = `
                        <span>${customer.name} (${customer.company})</span>
                        <span style="font-weight: bold; color: ${latestBalance < 0 ? 'red' : 'green'};">Balance: ${latestBalance.toLocaleString()} BDT</span>
                        <button onclick="selectCustomer('${id}')">View Ledger</button>
                    `;
                    listContainer.appendChild(item);
                }
            });
        }
        
        function addCustomer() {
            const name = document.getElementById('new-customer-name').value.trim();
            const company = document.getElementById('company-filter').value;
            if (name) {
                lastCustomerId++;
                const newId = `CUST-${String(lastCustomerId).padStart(3, '0')}`;
                CUSTOMER_DATA[newId] = { 
                    name: name, 
                    company: company,
                    transactions: [{ date: new Date().toISOString().substring(0, 10), desc: 'Opening Balance', bill: 'OPN-NEW', debit: 0, credit: 0, balance: 0 }]
                };
                document.getElementById('new-customer-name').value = '';
                populateCustomerList();
                alert(`Customer ${name} added under ${company}.`);
            } else {
                alert('Please enter a customer name.');
            }
        }

        function showCustomerSelector() {
            document.getElementById('customer-selector-view').style.display = 'block';
            document.getElementById('customer-transaction-view').style.display = 'none';
            selectedCustomerId = null;
            populateCustomerList();
        }

        function selectCustomer(id) {
            selectedCustomerId = id;
            const customer = CUSTOMER_DATA[id];
            
            document.getElementById('current-customer-name').textContent = `${customer.name} - ${customer.company}`;
            document.getElementById('customer-selector-view').style.display = 'none';
            document.getElementById('customer-transaction-view').style.display = 'block';

            populateCustomerLedgerTable(id);
        }

        function populateCustomerLedgerTable(id) {
            const customer = CUSTOMER_DATA[id];
            const tableBody = document.querySelector('#customer-ledger-table tbody');
            tableBody.innerHTML = '';
            
            customer.transactions.forEach(item => {
                const row = tableBody.insertRow();
                row.insertCell().textContent = item.date;
                row.insertCell().textContent = item.desc;
                row.insertCell().textContent = item.bill;
                row.insertCell().innerHTML = item.debit > 0 ? `<span class="text-danger">${item.debit.toLocaleString()}</span>` : '0';
                row.insertCell().innerHTML = item.credit > 0 ? `<span class="text-success">${item.credit.toLocaleString()}</span>` : '0';
                row.insertCell().innerHTML = `<span class="${item.balance < 0 ? 'text-danger' : 'text-success'}">${item.balance.toLocaleString()}</span>`;
            });

            // Update balance display
            const latestBalance = customer.transactions.length > 0 ? customer.transactions[customer.transactions.length - 1].balance : 0;
            document.getElementById('customer-current-balance').textContent = latestBalance.toLocaleString();
            document.getElementById('customer-current-balance').className = latestBalance < 0 ? 'text-danger' : 'text-success';
        }

        function addCustomerTransaction(event) {
            event.preventDefault();
            const customer = CUSTOMER_DATA[selectedCustomerId];
            if (!customer) return;

            const date = document.getElementById('t-date').value;
            const desc = document.getElementById('t-desc').value;
            const bill = document.getElementById('t-bill').value;
            const debit = parseInt(document.getElementById('t-debit').value) || 0;
            const credit = parseInt(document.getElementById('t-credit').value) || 0;
            
            if (debit === 0 && credit === 0) {
                alert('Please enter a Debit or Credit amount.');
                return;
            }

            const lastBalance = customer.transactions.length > 0 ? customer.transactions[customer.transactions.length - 1].balance : 0;
            const newBalance = lastBalance + debit - credit;

            customer.transactions.push({ date, desc, bill, debit, credit, balance: newBalance });

            // Clear form and refresh table
            document.getElementById('t-desc').value = 'Sales/Payment';
            document.getElementById('t-bill').value = '';
            document.getElementById('t-debit').value = '0';
            document.getElementById('t-credit').value = '0';
            populateCustomerLedgerTable(selectedCustomerId);
            alert(`Transaction entered for ${customer.name}. New balance: ${newBalance.toLocaleString()}.`);
        }
        
        // --- 3b) Stock Summary Functions (Filter Added) ---

        function populateProductList() {
            const listContainer = document.getElementById('product-list-container');
            const filterText = document.getElementById('product-filter-input').value.toLowerCase().trim();
            listContainer.innerHTML = '';
            
            Object.keys(STOCK_DATA).forEach(id => {
                const product = STOCK_DATA[id];
                
                // Recalculate stock for the summary view
                const lastMovement = product.movements.reduce((acc, m) => {
                    const goodsIn = m.type === 'in' ? m.qty : 0;
                    const goodsOut = m.type === 'out' ? m.qty : 0;
                    m.current_stock = acc + goodsIn - goodsOut;
                    return m.current_stock;
                }, 0);
                
                const latestStock = lastMovement;

                // Filter Logic: Check search text
                if (product.name.toLowerCase().includes(filterText)) {
                    const item = document.createElement('div');
                    item.className = 'selector-item';
                    item.innerHTML = `
                        <span>${product.name}</span>
                        <span style="font-weight: bold; color: ${latestStock <= 50 ? 'red' : 'green'};">Stock: ${latestStock.toLocaleString()} Units</span>
                        <button onclick="selectProduct('${id}')">View Stock</button>
                    `;
                    listContainer.appendChild(item);
                }
            });
            
            // Re-populate quick entry select after list update
            populateQuickEntryProductSelect();
        }

        function addProduct() {
            const name = document.getElementById('new-product-name').value.trim();
            if (name) {
                lastProductId++;
                const newId = `PROD-${String(lastProductId).padStart(3, '0')}`;
                STOCK_DATA[newId] = { 
                    name: name, 
                    unitPrice: 0,
                    movements: [{ date: new Date().toISOString().substring(0, 10), company: 'N/A', bill: 'OPN-NEW', type: 'in', qty: 0, price: 0, current_stock: 0 }]
                };
                document.getElementById('new-product-name').value = '';
                populateProductList();
                alert(`Product ${name} added.`);
            } else {
                alert('Please enter a product name.');
            }
        }
        
        function showProductSelector() {
            document.getElementById('product-selector-view').style.display = 'block';
            document.getElementById('product-movement-view').style.display = 'none';
            selectedProductId = null;
            populateProductList();
        }

        function selectProduct(id) {
            selectedProductId = id;
            const product = STOCK_DATA[id];
            
            document.getElementById('current-product-name').textContent = product.name;
            document.getElementById('product-selector-view').style.display = 'none';
            document.getElementById('product-movement-view').style.display = 'block';

            populateStockMovementTable(id);
        }

        function populateStockMovementTable(id) {
            const product = STOCK_DATA[id];
            const tableBody = document.querySelector('#stock-summary-table tbody');
            tableBody.innerHTML = '';
            
            let current_stock = 0;
            product.movements.forEach(item => {
                const goodsIn = item.type === 'in' ? item.qty : 0;
                const goodsOut = item.type === 'out' ? item.qty : 0;
                current_stock += goodsIn - goodsOut;
                item.current_stock = current_stock; // Update in-memory for accuracy
                
                const row = tableBody.insertRow();
                row.insertCell().textContent = item.date;
                row.insertCell().textContent = item.company;
                row.insertCell().textContent = item.bill;
                row.insertCell().innerHTML = goodsIn > 0 ? `<span class="text-success">${goodsIn.toLocaleString()}</span>` : '0';
                row.insertCell().innerHTML = goodsOut > 0 ? `<span class="text-danger">${goodsOut.toLocaleString()}</span>` : '0';
                row.insertCell().textContent = item.price.toLocaleString();
                row.insertCell().innerHTML = `<span class="${item.current_stock <= 50 ? 'text-danger' : 'text-success'}">${item.current_stock.toLocaleString()}</span>`;
            });

            // Update stock display
            const totalStock = current_stock;
            document.getElementById('product-total-stock').textContent = totalStock.toLocaleString();
            document.getElementById('product-total-stock').className = totalStock <= 50 ? 'text-danger' : 'text-success';
        }

        function addProductStock(event) {
            event.preventDefault();
            const product = STOCK_DATA[selectedProductId];
            if (!product) return;

            const date = document.getElementById('s-date').value;
            const company = document.getElementById('s-company-detail').value;
            const bill = document.getElementById('s-bill-detail').value;
            const goodsIn = parseInt(document.getElementById('s-in').value) || 0;
            const goodsOut = parseInt(document.getElementById('s-out').value) || 0;
            const price = parseInt(document.getElementById('s-price').value) || 0;
            
            if (goodsIn === 0 && goodsOut === 0) {
                alert('Please enter a Goods In or Goods Out quantity.');
                return;
            }
            if (goodsIn > 0 && goodsOut > 0) {
                 alert('Cannot record both Goods In and Goods Out in a single entry.');
                return;
            }
            const type = goodsIn > 0 ? 'in' : 'out';
            const qty = goodsIn > 0 ? goodsIn : goodsOut;

            // Update the last known unit price on the product data
            if(price > 0) product.unitPrice = price; 

            // Balance calculation will happen in populateStockMovementTable for consistency
            product.movements.push({ date, company, bill, type, qty, price, current_stock: 0 });
            
            // Clear form and refresh table
            document.getElementById('s-company-detail').value = 'Shahjalal Corporation';
            document.getElementById('s-bill-detail').value = '';
            document.getElementById('s-in').value = '0';
            document.getElementById('s-out').value = '0';
            document.getElementById('s-price').value = product.unitPrice.toString();
            
            populateStockMovementTable(selectedProductId);
            alert(`Stock movement recorded for ${product.name}.`);
        }
        
        // --- 3c) Goods Input (Quick Form) Functions (Select/Filter Added) ---
        
        function populateQuickEntryProductSelect() {
            const select = document.getElementById('goods-product-select');
            select.innerHTML = '';
            
            const products = Object.keys(STOCK_DATA).map(id => ({ id, name: STOCK_DATA[id].name }));
            
            if (products.length === 0) {
                select.innerHTML = '<option value="">No Products Found</option>';
                return;
            }
            
            products.forEach(p => {
                const option = document.createElement('option');
                option.value = p.id;
                option.textContent = p.name;
                select.appendChild(option);
            });
            
            // Update quick entry form with the first product's data
            updateQuickEntryForm(select.value);
            filterQuickEntryProducts(); // Run filter to hide non-matching items initially
        }
        
        function filterQuickEntryProducts() {
            const filterText = document.getElementById('goods-product-filter').value.toLowerCase().trim();
            const select = document.getElementById('goods-product-select');
            let firstVisibleId = null;

            for (let i = 0; i < select.options.length; i++) {
                const option = select.options[i];
                if (option.textContent.toLowerCase().includes(filterText) || filterText === '') {
                    option.style.display = '';
                    if (firstVisibleId === null) {
                        firstVisibleId = option.value;
                    }
                } else {
                    option.style.display = 'none';
                }
            }

            // Set the selected value to the first visible item if the current one is filtered out
            if (select.value !== firstVisibleId && firstVisibleId !== null) {
                select.value = firstVisibleId;
                updateQuickEntryForm(firstVisibleId);
            } else if (select.value === "" && firstVisibleId !== null) {
                 select.value = firstVisibleId;
                 updateQuickEntryForm(firstVisibleId);
            }
             if (firstVisibleId === null) {
                // Clear form if no matching product is found
                document.getElementById('goods-unit-price').value = '0';
                document.getElementById('goods-quantity').value = '0';
                document.getElementById('goods-total-price').value = '0';
            }
            calculateGoodsTotal();
        }
        
        function updateQuickEntryForm(productId) {
            const product = STOCK_DATA[productId];
            if (product) {
                // Use the last recorded price for convenience
                document.getElementById('goods-unit-price').value = product.unitPrice.toString();
                
                // Get current stock
                const totalStock = product.movements.length > 0 ? product.movements[product.movements.length - 1].current_stock : 0;
                document.getElementById('goods-final-balance').value = totalStock.toLocaleString();

            } else {
                document.getElementById('goods-unit-price').value = '0';
                document.getElementById('goods-final-balance').value = 'N/A';
            }
            calculateGoodsTotal();
        }

        function calculateGoodsTotal() {
            const quantity = parseInt(document.getElementById('goods-quantity').value) || 0;
            const unitPrice = parseFloat(document.getElementById('goods-unit-price').value) || 0;
            const total = quantity * unitPrice;
            document.getElementById('goods-total-price').value = total.toLocaleString('en-US', { minimumFractionDigits: 0, maximumFractionDigits: 2 });
        }
        
        function updateGoodsLabels(type) {
            // Visual changes if needed
        }

        function handleGoodsInput(event) {
            event.preventDefault();
            
            const productId = document.getElementById('goods-product-select').value;
            if (!productId) {
                alert('Please select a valid product.');
                return;
            }
            
            const product = STOCK_DATA[productId];

            const date = document.getElementById('goods-date').value;
            const company = document.getElementById('goods-company').value;
            const bill = document.getElementById('goods-billno').value;
            const type = document.getElementById('goods-type').value;
            const quantity = parseInt(document.getElementById('goods-quantity').value) || 0;
            const unitPrice = parseFloat(document.getElementById('goods-unit-price').value) || 0;
            
            if (quantity === 0 || unitPrice === 0) {
                alert('Quantity and Unit Price must be greater than zero.');
                return;
            }

            // Update the last known unit price on the product data
            if(unitPrice > 0) product.unitPrice = unitPrice; 

            // Simulate adding data to Stock Data
            const goodsIn = type === 'in' ? quantity : 0;
            const goodsOut = type === 'out' ? quantity : 0;
            const qty = quantity;
            
            product.movements.push({ date, company, bill, type, qty, price: unitPrice, current_stock: 0 });

            // Recalculate and update the total stock in the quick entry form
            let current_stock = 0;
            product.movements.forEach(item => {
                const itemIn = item.type === 'in' ? item.qty : 0;
                const itemOut = item.type === 'out' ? item.qty : 0;
                current_stock += itemIn - itemOut;
                item.current_stock = current_stock;
            });
            document.getElementById('goods-final-balance').value = current_stock.toLocaleString();

            const transactionData = {
                Date: date,
                Company: company,
                Bill: bill,
                Product: product.name,
                Type: type.toUpperCase(),
                Quantity: quantity.toLocaleString(),
                Total_Price: (quantity * unitPrice).toLocaleString(),
                Final_Balance: current_stock.toLocaleString()
            };

            console.log(`--- Goods Transaction Recorded from Quick Form (${currentBranch}) ---`);
            console.log(transactionData);
            console.log('--------------------------------------------------------------------');
            
            alert(`Transaction recorded for ${product.name} (${type.toUpperCase()}). Current stock: ${current_stock.toLocaleString()} units.`);

            // Reset inputs to default demo values for the next quick entry
            document.getElementById('goods-quantity').value = '100';
            document.getElementById('goods-unit-price').value = product.unitPrice.toString();
            document.getElementById('goods-billno').value = `GR-${Math.floor(Math.random() * 100)}`;
            calculateGoodsTotal(); // Update total after reset
        }
        
        // --- 3e) Sales Report Functions ---
        function generateSalesReport() {
            const period = document.getElementById('report-period').value;
            const periodDisplay = document.getElementById('report-period-display');
            const tableBody = document.querySelector('#sales-report-table tbody');
            
            periodDisplay.textContent = period.charAt(0).toUpperCase() + period.slice(1);
            tableBody.innerHTML = '';
            
            // 1. Filter Sales Movements (Demo: All 'out' movements are considered sales)
            const salesData = {};
            let totalSalesQty = 0;
            let totalSalesAmount = 0;
            
            // In a real application, date filtering logic would go here.
            // For this demo, we use all 'out' movements in STOCK_DATA.
            
            Object.keys(STOCK_DATA).forEach(productId => {
                const product = STOCK_DATA[productId];
                
                product.movements.filter(m => m.type === 'out').forEach(movement => {
                    const amount = movement.qty * movement.price;
                    
                    if (!salesData[product.name]) {
                        salesData[product.name] = { qty: 0, amount: 0 };
                    }
                    
                    salesData[product.name].qty += movement.qty;
                    salesData[product.name].amount += amount;
                    
                    totalSalesQty += movement.qty;
                    totalSalesAmount += amount;
                });
            });

            // 2. Populate Table
            for (const itemName in salesData) {
                const data = salesData[itemName];
                const row = tableBody.insertRow();
                row.insertCell().textContent = itemName;
                row.insertCell().textContent = data.qty.toLocaleString();
                row.insertCell().textContent = data.amount.toLocaleString();
            }
            
            // 3. Add Total Row
            const totalRow = tableBody.insertRow();
            totalRow.classList.add('total-row');
            totalRow.insertCell().textContent = 'TOTAL';
            totalRow.insertCell().textContent = totalSalesQty.toLocaleString();
            totalRow.insertCell().textContent = totalSalesAmount.toLocaleString();
            
            // 4. Update Summary Cards
            document.getElementById('total-sales-qty').textContent = `${totalSalesQty.toLocaleString()} Units`;
            document.getElementById('total-sales-amount').textContent = `BDT ${totalSalesAmount.toLocaleString()}`;
        }


        // --- Admin View Functions ---
        function viewBranchDetails(branchName) {
            document.getElementById('branch-performance-container').style.display = 'none';
            document.getElementById('admin-branch-detail').classList.remove('hidden-section');
            document.getElementById('admin-detail-title').textContent = `Detailed Report for ${branchName} Branch`;
            alert(`Simulating load of detailed Customer Ledger and Stock data for ${branchName}.`);
        }

        function hideBranchDetails() {
            document.getElementById('branch-performance-container').style.display = 'grid';
            document.getElementById('admin-branch-detail').classList.add('hidden-section');
        }

        // --- Reminder Functions ---
        function populateReminderList() {
            const list = document.getElementById('reminder-list');
            list.innerHTML = '';
            if (activeReminders.length === 0) {
                list.innerHTML = '<li>No active reminders.</li>';
                return;
            }
            activeReminders.forEach((reminder, index) => {
                const li = document.createElement('li');
                li.innerHTML = `${reminder} <button style="float:right; background:none; border:none; color:red; cursor:pointer;" onclick="removeReminder(${index})">&times;</button>`;
                list.appendChild(li);
            });
        }
        
        function addReminder(event) {
            event.preventDefault();
            const reminderText = document.getElementById('reminder-text').value.trim();
            if (reminderText) {
                activeReminders.unshift(reminderText);
                populateReminderList();
                document.getElementById('reminder-text').value = '';
                alert('Reminder added successfully!');
            }
        }
        
        function removeReminder(index) {
            activeReminders.splice(index, 1);
            populateReminderList();
        }

        function updateDashboardView() {
            // Re-run customer list filter when company changes
            populateCustomerList();
        }

        // --- Initial setup ---
        document.addEventListener('DOMContentLoaded', () => {
            showScreen('home-page');
            // Initial setup for the product list in quick entry (run before goods section is shown)
            populateQuickEntryProductSelect();
        });
    </script>

</body>
</html>
